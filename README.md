# 房价预测深度学习模型

这是一个基于深度学习的房价预测模型，用于Kaggle竞赛"House Prices - Advanced Regression Techniques"。

## 项目概述

本项目使用PyTorch构建了一个深度神经网络来预测房屋销售价格。模型包含了完整的数据预处理、特征工程、模型训练和预测流程。

## 特征说明

数据集包含以下主要特征类别：

- **建筑特征**: 房屋类型、风格、质量等级、建造年份等
- **位置特征**: 邻里、分区、街道类型等
- **面积特征**: 地下室面积、楼层面积、车库面积等
- **设施特征**: 浴室数量、厨房质量、供暖系统等
- **外部特征**: 外墙材料、屋顶类型、车道类型等

## 模型架构

### 神经网络结构
- **输入层**: 根据特征数量动态调整
- **隐藏层**: 512 → 256 → 128 → 64 神经元
- **激活函数**: ReLU
- **正则化**: Batch Normalization + Dropout (30%)
- **输出层**: 1个神经元（房价预测）

### 训练参数
- **优化器**: Adam
- **学习率**: 0.001
- **损失函数**: 均方误差 (MSE)
- **学习率调度**: ReduceLROnPlateau
- **批次大小**: 64
- **训练轮数**: 150

## 特征工程

### 新创建的特征
1. **TotalSF**: 总面积（地下室 + 一楼 + 二楼）
2. **TotalBathrooms**: 浴室总数（完整浴室 + 0.5 × 半浴室）
3. **HouseAge**: 房屋年龄
4. **RemodelAge**: 翻修年龄
5. **OverallScore**: 整体质量评分
6. **NeighborhoodScore**: 邻里评分（基于房价中位数）

### 质量评分转换
- 外部质量、厨房质量等转换为数值评分
- 地下室、车库质量转换为数值评分
- 功能性、销售条件转换为数值评分

## 安装和运行

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行模型
```bash
python house_price_prediction.py
```

### 3. 输出文件
- `submission.csv`: 预测结果提交文件
- `training_loss.png`: 训练损失曲线图
- `prediction_vs_actual.png`: 预测vs实际价格对比图

## 数据预处理流程

1. **数据加载**: 读取训练和测试数据
2. **缺失值处理**: 数值型用中位数，分类型用众数
3. **特征工程**: 创建新特征和转换现有特征
4. **分类编码**: 使用LabelEncoder编码分类变量
5. **特征标准化**: 使用StandardScaler标准化数值特征

## 模型评估

模型使用以下指标进行评估：
- **MSE**: 均方误差
- **RMSE**: 均方根误差
- **MAE**: 平均绝对误差
- **R²**: 决定系数

## 竞赛提交

生成的`submission.csv`文件可以直接提交到Kaggle竞赛。文件包含两列：
- `Id`: 房屋ID
- `SalePrice`: 预测的房价

## 技术特点

- **端到端流程**: 从数据加载到预测生成的完整流程
- **自动化特征工程**: 智能创建和转换特征
- **深度学习架构**: 使用现代神经网络技术
- **可视化分析**: 训练过程和预测结果的可视化
- **可扩展性**: 模块化设计，易于修改和扩展

## 性能优化建议

1. **特征选择**: 可以使用特征重要性分析选择最重要的特征
2. **超参数调优**: 使用网格搜索或贝叶斯优化调整超参数
3. **集成学习**: 结合多个模型的预测结果
4. **交叉验证**: 使用K折交叉验证提高模型稳定性

## 注意事项

- 确保有足够的内存运行模型
- GPU加速可以显著提高训练速度
- 模型训练时间取决于数据规模和硬件配置
- 建议在运行前备份原始数据

## 许可证

本项目仅供学习和研究使用。 